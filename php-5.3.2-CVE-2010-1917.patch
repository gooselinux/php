
https://bugzilla.redhat.com/show_bug.cgi?id=617232
http://svn.php.net/viewvc?view=revision&revision=298881

--- php-5.3.2/ext/standard/file.c.cve1917
+++ php-5.3.2/ext/standard/file.c
@@ -2518,6 +2518,10 @@ PHP_FUNCTION(fnmatch)
 		php_error_docref(NULL TSRMLS_CC, E_WARNING, "Filename exceeds the maximum allowed length of %d characters", MAXPATHLEN);
 		RETURN_FALSE;
 	}
+	if (pattern_len >= MAXPATHLEN) {
+		php_error_docref(NULL TSRMLS_CC, E_WARNING, "Pattern exceeds the maximum allowed length of %d characters", MAXPATHLEN);
+		RETURN_FALSE;
+	}
 
 	RETURN_BOOL( ! fnmatch( pattern, filename, flags ));
 }
